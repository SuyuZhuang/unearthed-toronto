{% extends "header.html" %}

{% block title %}Home{% endblock %}




{% block style %}
h3, p{
	color:#999999;
}

.container {
	width: 100%;
	padding: 0;
}

.container-fluid {
	width: 100%;
}

/* Style page content - use this if you want to push the page content to the right when you open the side navigation */
#mapid {
    transition: margin-left .5s;
}
{% endblock %}


{% block page_header %}
{% endblock %}

{% block content %}
	<div id="mySidenav" class="sidenav">
		<a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
		<a href="#">Option 1</a>
		<a href="#">Option 2</a>
		<a href="#">Option 3</a>
	</div>


	<!-- <div style="text-align: center; width: 100%; margin: 30px auto auto auto;">
		<h1>Beautiful Map</h1>
		<h3>An interactive map that displays mining activity.</h3>
	</div> -->

	<div id="mapid" style="height: 500px;"></div>


<script>
function vertical_resize() {
	var h = $(window).height() - 90;
	$('.sidenav').height(h);
	//alert($('#mySidenav').height());
	$('#mapid').height(h);
}

window.onload = vertical_resize;

var meta1nJson={
	"type": "FeatureCollection",
	"features": [
		{
			"type": "Feature",
			"geometry": {
				"type": "Point",
				"coordinates": [
				-38.3613558,
				-8.8044875
				]
			},
			"properties": {
				"Ordem": "193",
				"Eixo": "Leste",
				"Meta": "1L",
				"Municipio": "Petrolândia",
				"Estado": "PE",
				"Nome da Comunidade": "Agrovila 4"
			}
		},
		{
			"type": "Feature",
			"geometry": {
				"type": "Point",
				"coordinates": [
				-38.3445892,
				-8.7940031
				]
			},
			"properties": {
				"Ordem": "194",
				"Eixo": "Leste",
				"Meta": "1L",
				"Municipio": "Petrolândia / Floresta",
				"Estado": "PE",
				"Nome da Comunidade": "Agrovila 5"
			}
		},
		{
			"type": "Feature",
			"geometry": {
				"type": "Point",
				"coordinates": [
				-37.8521847,
				-8.6774657
				]
			},
			"properties": {
				"Ordem": "195",
				"Eixo": "Leste",
				"Meta": "1L",
				"Municipio": "InajÃ¡/Ibimirim",
				"Estado": "PE",
				"Nome da Comunidade": "Indígena KambiwÃ¡ - Baxa da Alexandra"
			}
		},
		{
			"type": "Feature",
			"geometry": {
				"type": "Point",
				"coordinates": [
				-37.9229577,
				-8.645232
				]
			},
			"properties": {
				"Ordem": "196",
				"Eixo": "Leste",
				"Meta": "1L",
				"Municipio": "InajÃ¡",
				"Estado": "PE",
				"Nome da Comunidade": "Indígena KambiwÃ¡ -  BarracÃ£o"
			}
		}
	]
};

var mymap = L.map('mapid').setView([-8.65, -37.92], 13);


L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/outdoors-v10/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZGxpbjE3IiwiYSI6ImNpcmsyMGxudzAwMnlmYm5icXlzYWsxd2IifQ.MUxIcntS8U8rRa41fbPo_Q', {
	maxZoom: 18,
	attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
		'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
		'Imagery © <a href="http://mapbox.com">Mapbox</a>',
	id: 'mapbox.streets'
}).addTo(mymap);

function onEachFeature(feature, layer) {
	if (feature.properties && feature.properties.Municipio) {
		layer.bindPopup(feature.properties.Municipio).on('mouseover', function (e) {this.openPopup();});
		layer.bindPopup(feature.properties.Municipio).on('mouseout', function (e) {this.closePopup();});
		layer.bindPopup(feature.properties.Municipio).on('click', function (e) {openNav();});
	}
}

new L.GeoJSON(meta1nJson, {
	onEachFeature: onEachFeature
}).addTo(mymap)

mymap.on('click', onClick_close)

function onClick_close(e) {
	closeNav();
}

/* Set the width of the side navigation to 250px */
function openNav() {
	document.getElementById("mySidenav").style.width = "400px";
	document.getElementById("mapid").style.marginLeft = "400px";
}

/* Set the width of the side navigation to 0 */
function closeNav() {
	document.getElementById("mySidenav").style.width = "0";
	document.getElementById("mapid").style.marginLeft = "0";
}
</script>

{% endblock %}
